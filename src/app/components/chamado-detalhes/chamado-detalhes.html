<div class="container-fluid pt-3 px-3">
  <a [routerLink]="['/chamados']" class="text-decoration-none text-dark"
    ><i class="bi bi-arrow-left-short"></i>Voltar</a
  >
</div>
<section class="container-fluid d-flex flex-row p-3">
  <main class="d-flex flex-column flex-nowrap p-3 w-75">
    <div class="p-3 mb-3 rounded-2 border border-1" style="min-height: 160px">
      <p class="badge bg-dark fw-bold mx-1">
        {{ chamado?.categoria?.nmCategoria || chamado?.categoria }}
      </p>
      <p class="badge bg-primary fw-bold mx-1">
        {{ chamado?.status }}
      </p>
      <p class="fw-bold">{{ chamado?.dsTitulo }}</p>
      <p class="text-muted">{{ chamado?.dsDescricao }}</p>
    </div>
    <div class="d-flex flex-column flex-nowrap p-3 rounded-2 border border-1">
      <p>Conversação</p>
      @if (comentarios.length > 0) { @for(comentario of comentarios; track $index) {
      <div class="rounded-2 border border-1 mb-3 p-3">
        <p>{{ comentario?.dtCriacao }} | {{ comentario?.hrCriacao }}</p>
        <p>{{ comentario?.dsConteudo }}</p>
        <p>{{ comentario?.usuario?.nmUsuario }}</p>
      </div>
      } } @else {
      <p class="text-muted">Nenhuma conversa ainda...</p>
      }
      <hr />
      <p>Nova mensagem</p>
      <textarea
        [(ngModel)]="novoConteudo"
        class="rounded-2 border border-1 border-dark mb-3 p-2"
        style="min-height: 100px"
        placeholder="Digite seu comentário aqui..."
      ></textarea>
      <button
        (click)="enviarComentario()"
        [disabled]="enviando || !novoConteudo.trim()"
        class="btn btn-outline-dark rounded-2 w-25 align-start"
      >
        {{ enviando ? 'Enviando...' : 'Enviar' }}
      </button>
    </div>
  </main>
  <aside class="d-flex flex-column flex-nowrap p-3 w-25">
    <div class="p-3 mb-3 rounded-2 border border-1" style="min-height: 160px">
      <p>Status</p>
      <select class="rounded-2 border border-1 border-dark px-3">
        <option value="1">Aberto</option>
        <option value="2">Em andamento</option>
        <option value="3">Resolvido</option>
        <option value="4">Fechado</option>
      </select>
    </div>
    <div class="p-3 mb-3 rounded-2 border border-1">
      <p class="fw-light"><strong>Detalhes</strong></p>
      <p class="fw-light">
        <i class="bi bi-person"></i>
        Solicitante<br /><strong>{{ chamado?.solicitante?.nmUsuario }}</strong>
      </p>
      <p class="fw-light">
        <i class="bi bi-person"></i>
        Atribuído a<br /><strong>{{ chamado?.responsavel?.nmUsuario }}</strong>
      </p>
      <p class="fw-light">
        <i class="bi bi-tag me-1"></i>
        Categoria<br /><strong>{{ chamado?.categoria?.nmCategoria }}</strong>
      </p>
      <p class="fw-light">
        <i class="bi bi-calendar"></i>
        Criado em<br /><strong>{{ chamado?.dtCriacao }}</strong>
      </p>
      <p class="fw-light">
        <i class="bi bi-stopwatch"></i>
        Vencimento em<br /><strong>{{ chamado?.dtVencimento }}</strong>
      </p>
    </div>
  </aside>
</section>
