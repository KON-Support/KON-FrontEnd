<app-navbar></app-navbar>
<div class="px-5 py-5">
  <div class="row">
    <div class="col-md-12 mt-5 d-flex justify-content-between align-items-center">
      <div class="col-md-9">
        <h3>Tickets</h3>
        <h5 class="text-muted">{{ ticketsFiltrados.length }} chamados encontrados</h5>
      </div>
      <div class="col-md-3 d-flex justify-content-end">
        <a
          routerLink="/novo-ticket"
          class="btn bg-dark text-white align-self-center text-decoration-none"
        >
          <i class="bi bi-plus-circle"></i> Novo Ticket
        </a>
      </div>
    </div>
  </div>

  <div class="mt-4">
    <div class="row border opacity-100 py-3 rounded m-0">
      <div class="col-md-4">
        <div class="input-group">
          <span class="input-group-text text-white input-bg">
            <i class="bi bi-search text-muted"></i>
          </span>
          <input
            type="text"
            class="form-control input-bg"
            placeholder="Buscar chamado..."
            [(ngModel)]="filtroBusca"
          />
        </div>
      </div>

      <div class="col-md-4">
        <div class="input-group">
          <span class="input-group-text text-white input-bg">
            <i class="bi bi-file-earmark-text text-muted"></i>
          </span>
          <select
            name="status"
            id="todosStatus"
            class="form-select input-bg"
            [(ngModel)]="filtroStatus"
          >
            <option value="">Todos os status</option>
            <option value="aberto">Aberto</option>
            <option value="andamento">Em Andamento</option>
            <option value="fechado">Fechado</option>
          </select>
        </div>
      </div>

      <div class="col-md-4">
        <div class="input-group">
          <span class="input-group-text text-white input-bg">
            <i class="bi bi-flag text-muted"></i>
          </span>
          <select
            name="prioridade"
            id="todasPrioridades"
            class="form-select input-bg"
            [(ngModel)]="filtroCategoria"
          >
            <option value="">Todas as categorias</option>
            @for (categoria of categorias(); track categoria.cdCategoria) {
            <option value="{{ categoria.nmCategoria }}">{{ categoria.nmCategoria }}</option>
            }
          </select>
        </div>
      </div>
    </div>
  </div>
</div>

@if (loading()) {
<div class="text-center py-5">
  <div class="spinner-border text-primary" role="status">
    <span class="visually-hidden">Carregando...</span>
  </div>
  <p class="mt-2 text-muted">Carregando tickets...</p>
</div>
} @else {
<app-lista-chamados [tickets]="ticketsFiltrados"></app-lista-chamados>
}
